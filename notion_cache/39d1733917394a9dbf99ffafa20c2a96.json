{
  "ID": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
  "Root": {
    "alive": true,
    "content": [
      "ba8d3ae9-7a1a-46a9-8ea2-7295a1d33539",
      "b2b85bb8-b06a-42f7-8d20-a38ba2126dc5",
      "d0e62926-14b7-4fa3-b59b-5ba598b8a54b",
      "25c1db05-c969-4578-ac53-ce75d36b0a17",
      "f196a6e8-1c1e-4747-8afd-212ed940dd03",
      "7321acea-a131-4a4e-a3a6-f9ef3b2714aa",
      "98e566b8-ce89-4094-85c2-54ae1741ecc6",
      "9f00cff5-fb43-4541-83df-91d45f1ae4f5",
      "b33564e7-dfe0-4d50-916d-d7e8e0bc8f33",
      "9f4ae5f9-9e2f-46c3-971c-b201d0e32c4a",
      "08af8a14-96bf-4b3e-bdb1-4d09c11c12ad",
      "20ce03c5-689e-474d-bc2f-87ccd713356e",
      "d69c8a07-84b4-4de0-aceb-48ebbcefaf05",
      "870097a5-4586-477e-9984-d01759ac3685",
      "f1c163d5-98ac-4c80-87bf-81c66684398a",
      "5cb75d4d-3c42-4486-94a3-ff214e435713",
      "264ddced-b032-4a71-9815-7badf7206974",
      "567e43cb-28ad-42e4-9682-502181abcb36",
      "e33a036c-229b-4502-8c08-e2f990039288",
      "4eaf2a38-eae7-4a8a-92c4-240bdec406ea",
      "892a570a-b983-43b4-8fb7-8de9809ebc5c",
      "15cba0fc-ac2e-48c5-a119-16a375451612",
      "85b99805-5db8-4ef1-a8a2-0f7180ff0389",
      "11610a85-48e9-4981-ad49-67056fb48cef",
      "c02cbad1-ccac-4f61-acce-d6ebd90398bc",
      "6f72f637-2be1-492c-ade0-11c10f160d5b",
      "1f95f8f1-094e-4e98-9b97-593274d92df5",
      "98aa694f-90fa-4d25-8188-cf505017c8be",
      "f2624055-e427-48c5-b8e6-b18dfdd88b2e",
      "112805bf-cf9c-4c00-ab26-a21bca7c00e5"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1531888786897,
    "file_ids": [
      "f4649414-a80a-475f-92bf-dfda91b0689a"
    ],
    "format": {
      "page_cover": "https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f4649414-a80a-475f-92bf-dfda91b0689a/header-10.jpg",
      "page_full_width": true,
      "page_small_text": true,
      "page_cover_position": 0.5
    },
    "id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
    "ignore_block_count": true,
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1532405771089,
    "parent_id": "7495260a-1daa-4611-8858-ad2e049e77e6",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Embedding build number in Go executable"
        ]
      ]
    },
    "type": "page",
    "version": 50,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889723047,
        "id": "ba8d3ae9-7a1a-46a9-8ea2-7295a1d33539",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889738467,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Id: vEja"
            ]
          ]
        },
        "type": "text",
        "version": 6,
        "inline_content": [
          {
            "Text": "Id: vEja"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889723048,
        "id": "b2b85bb8-b06a-42f7-8d20-a38ba2126dc5",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889723055,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Tags: go"
            ]
          ]
        },
        "type": "text",
        "version": 2,
        "inline_content": [
          {
            "Text": "Tags: go"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889723048,
        "id": "d0e62926-14b7-4fa3-b59b-5ba598b8a54b",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889723055,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "CreatedAt: 2017-07-07T09:01:20Z"
            ]
          ]
        },
        "type": "text",
        "version": 2,
        "inline_content": [
          {
            "Text": "CreatedAt: 2017-07-07T09:01:20Z"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889723048,
        "id": "25c1db05-c969-4578-ac53-ce75d36b0a17",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889723055,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "UpdatedAt: 2017-07-09T01:50:32Z"
            ]
          ]
        },
        "type": "text",
        "version": 2,
        "inline_content": [
          {
            "Text": "UpdatedAt: 2017-07-09T01:50:32Z"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889723048,
        "id": "f196a6e8-1c1e-4747-8afd-212ed940dd03",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1532405771089,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "PublishedOn: 2017-07-13"
            ]
          ]
        },
        "type": "text",
        "version": 4,
        "inline_content": [
          {
            "Text": "PublishedOn: 2017-07-13"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889723048,
        "id": "7321acea-a131-4a4e-a3a6-f9ef3b2714aa",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889723055,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Collection: go-cookbook"
            ]
          ]
        },
        "type": "text",
        "version": 2,
        "inline_content": [
          {
            "Text": "Collection: go-cookbook"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889723048,
        "id": "98e566b8-ce89-4094-85c2-54ae1741ecc6",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889723055,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Description: How to embed build number in Go executable."
            ]
          ]
        },
        "type": "text",
        "version": 2,
        "inline_content": [
          {
            "Text": "Description: How to embed build number in Go executable."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889726486,
        "id": "9f00cff5-fb43-4541-83df-91d45f1ae4f5",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889726486,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "type": "text",
        "version": 4
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786887,
        "id": "b33564e7-dfe0-4d50-916d-d7e8e0bc8f33",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786887,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "So you’ve deployed your web application to production and it’s running on a server far, far away."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "So you’ve deployed your web application to production and it’s running on a server far, far away."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786889,
        "id": "9f4ae5f9-9e2f-46c3-971c-b201d0e32c4a",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786889,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "When debugging problems it’s good to know what version of the code is running."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "When debugging problems it’s good to know what version of the code is running."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786889,
        "id": "08af8a14-96bf-4b3e-bdb1-4d09c11c12ad",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786889,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "If you’re using git, that would be sha1 of the revision used to build the program."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "If you’re using git, that would be sha1 of the revision used to build the program."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786889,
        "id": "20ce03c5-689e-474d-bc2f-87ccd713356e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786889,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "We can embed that version in the executable during build thanks Go linker’s "
            ],
            [
              "-X",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " option which allows to change any variable in the program."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "We can embed that version in the executable during build thanks Go linker’s "
          },
          {
            "Text": "-X",
            "AttrFlags": 2
          },
          {
            "Text": " option which allows to change any variable in the program."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786889,
        "id": "d69c8a07-84b4-4de0-aceb-48ebbcefaf05",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786889,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "In our Go program we would have:"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "In our Go program we would have:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786889,
        "id": "870097a5-4586-477e-9984-d01759ac3685",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889671280,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Go"
            ]
          ],
          "title": [
            [
              "package main\n\nvar (\n    sha1ver   string // sha1 revision used to build the program\n    buildTime string // when the executable was built\n)"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "package main\n\nvar (\n    sha1ver   string // sha1 revision used to build the program\n    buildTime string // when the executable was built\n)",
        "code_language": "Go"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786890,
        "id": "f1c163d5-98ac-4c80-87bf-81c66684398a",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786890,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "We can set that variable to sha1 of the git revision in our build script "
            ],
            [
              "build.sh",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "We can set that variable to sha1 of the git revision in our build script "
          },
          {
            "Text": "build.sh",
            "AttrFlags": 2
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786890,
        "id": "5cb75d4d-3c42-4486-94a3-ff214e435713",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889673600,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Go"
            ]
          ],
          "title": [
            [
              "#!/bin/bash\n\n# notice how we avoid spaces in $now to avoid quotation hell in go build command\nnow=$(date +'%Y-%m-%d_%T')\ngo build -ldflags \"-X main.sha1ver=`git rev-parse HEAD` -X main.buildTime=$now\""
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "#!/bin/bash\n\n# notice how we avoid spaces in $now to avoid quotation hell in go build command\nnow=$(date +'%Y-%m-%d_%T')\ngo build -ldflags \"-X main.sha1ver=`git rev-parse HEAD` -X main.buildTime=$now\"",
        "code_language": "Go"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786891,
        "id": "264ddced-b032-4a71-9815-7badf7206974",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786891,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Full example: "
            ],
            [
              "embed-build-number/build.sh",
              [
                [
                  "a",
                  "https://github.com/kjk/go-cookbook/blob/master/embed-build-number/build.sh"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Full example: "
          },
          {
            "Text": "embed-build-number/build.sh",
            "Link": "https://github.com/kjk/go-cookbook/blob/master/embed-build-number/build.sh"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786891,
        "id": "567e43cb-28ad-42e4-9682-502181abcb36",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786891,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "On Windows we would write powershell script "
            ],
            [
              "build.ps1",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "On Windows we would write powershell script "
          },
          {
            "Text": "build.ps1",
            "AttrFlags": 2
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786891,
        "id": "e33a036c-229b-4502-8c08-e2f990039288",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889675824,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Go"
            ]
          ],
          "title": [
            [
              "# notice how we avoid spaces in $now to avoid quotation hell in go build command\n$now = Get-Date -UFormat \"%Y-%m-%d_%T\"\n$sha1 = (git rev-parse HEAD).Trim()\n\ngo build -ldflags \"-X main.sha1ver=$sha1 -X main.buildTime=$now\""
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "# notice how we avoid spaces in $now to avoid quotation hell in go build command\n$now = Get-Date -UFormat \"%Y-%m-%d_%T\"\n$sha1 = (git rev-parse HEAD).Trim()\n\ngo build -ldflags \"-X main.sha1ver=$sha1 -X main.buildTime=$now\"",
        "code_language": "Go"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786892,
        "id": "4eaf2a38-eae7-4a8a-92c4-240bdec406ea",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786892,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Full example: "
            ],
            [
              "embed-build-number/build.ps1",
              [
                [
                  "a",
                  "https://github.com/kjk/go-cookbook/blob/master/embed-build-number/build.ps1"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "Full example: "
          },
          {
            "Text": "embed-build-number/build.ps1",
            "Link": "https://github.com/kjk/go-cookbook/blob/master/embed-build-number/build.ps1"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786893,
        "id": "892a570a-b983-43b4-8fb7-8de9809ebc5c",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889692535,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Let’s deconstruct:"
            ]
          ]
        },
        "type": "text",
        "version": 3,
        "inline_content": [
          {
            "Text": "Let’s deconstruct:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889692535,
        "id": "15cba0fc-ac2e-48c5-a119-16a375451612",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889700026,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "git rev-parse HEAD",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " returns sha1 of the current revision, e.g. "
            ],
            [
              "e5ce06c1f604efb1de91d515d5de865e7e164d59",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 21,
        "inline_content": [
          {
            "Text": "git rev-parse HEAD",
            "AttrFlags": 2
          },
          {
            "Text": " returns sha1 of the current revision, e.g. "
          },
          {
            "Text": "e5ce06c1f604efb1de91d515d5de865e7e164d59",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889700026,
        "id": "85b99805-5db8-4ef1-a8a2-0f7180ff0389",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889706791,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "-X main.sha1ver=${foo}",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " tells Go linker to set variable "
            ],
            [
              "sha1ver",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " in package "
            ],
            [
              "main",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " to "
            ],
            [
              "${foo}",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 14,
        "inline_content": [
          {
            "Text": "-X main.sha1ver=${foo}",
            "AttrFlags": 2
          },
          {
            "Text": " tells Go linker to set variable "
          },
          {
            "Text": "sha1ver",
            "AttrFlags": 2
          },
          {
            "Text": " in package "
          },
          {
            "Text": "main",
            "AttrFlags": 2
          },
          {
            "Text": " to "
          },
          {
            "Text": "${foo}",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531889706791,
        "id": "11610a85-48e9-4981-ad49-67056fb48cef",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889708398,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "-ldflags \"${flags}\"",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " tells Go build tool to pass "
            ],
            [
              "${flags}",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " to go linker"
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 12,
        "inline_content": [
          {
            "Text": "-ldflags \"${flags}\"",
            "AttrFlags": 2
          },
          {
            "Text": " tells Go build tool to pass "
          },
          {
            "Text": "${flags}",
            "AttrFlags": 2
          },
          {
            "Text": " to go linker"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786894,
        "id": "c02cbad1-ccac-4f61-acce-d6ebd90398bc",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786894,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "We also need an easy way to see that version. We can add "
            ],
            [
              "-version",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " cmd-line flag to "
            ],
            [
              "print it out",
              [
                [
                  "a",
                  "https://github.com/kjk/go-cookbook/blob/master/embed-build-number/main.go#L26"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "We also need an easy way to see that version. We can add "
          },
          {
            "Text": "-version",
            "AttrFlags": 2
          },
          {
            "Text": " cmd-line flag to "
          },
          {
            "Text": "print it out",
            "Link": "https://github.com/kjk/go-cookbook/blob/master/embed-build-number/main.go#L26"
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786894,
        "id": "6f72f637-2be1-492c-ade0-11c10f160d5b",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889678822,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Go"
            ]
          ],
          "title": [
            [
              "var (\n    flgVersion bool\n)\n\nfunc parseCmdLineFlags() {\n    flag.BoolVar(\u0026flgVersion, \"version\", false, \"if true, print version and exit\")\n    flag.Parse()\n    if flgVersion {\n        fmt.Printf(\"Build on %s from sha1 %s\\n\", buildTime, sha1ver)\n        os.Exit(0)\n    }\n}"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "var (\n    flgVersion bool\n)\n\nfunc parseCmdLineFlags() {\n    flag.BoolVar(\u0026flgVersion, \"version\", false, \"if true, print version and exit\")\n    flag.Parse()\n    if flgVersion {\n        fmt.Printf(\"Build on %s from sha1 %s\\n\", buildTime, sha1ver)\n        os.Exit(0)\n    }\n}",
        "code_language": "Go"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786895,
        "id": "1f95f8f1-094e-4e98-9b97-593274d92df5",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786895,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "If this is a web application, we can additionally add a debug page that would show the version. I often do it "
            ],
            [
              "like that",
              [
                [
                  "a",
                  "https://github.com/kjk/go-cookbook/blob/master/embed-build-number/main.go#L43"
                ]
              ]
            ],
            [
              ":"
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "If this is a web application, we can additionally add a debug page that would show the version. I often do it "
          },
          {
            "Text": "like that",
            "Link": "https://github.com/kjk/go-cookbook/blob/master/embed-build-number/main.go#L43"
          },
          {
            "Text": ":"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786896,
        "id": "98aa694f-90fa-4d25-8188-cf505017c8be",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889684479,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "language": [
            [
              "Go"
            ]
          ],
          "title": [
            [
              "func servePlainText(w http.ResponseWriter, s string) {\n    w.Header().Set(\"Content-Type\", \"text/plain\")\n    w.Header().Set(\"Content-Length\", strconv.Itoa(len(s)))\n    w.WriteHeader(http.StatusOK)\n    w.Write([]byte(s))\n}\n\n// /app/debug\nfunc handleDebug(w http.ResponseWriter, r *http.Request) {\n    s := fmt.Sprintf(\"url: %s %s\", r.Method, r.RequestURI)\n    a := []string{s}\n\n    a = append(a, \"Headers:\")\n    for k, v := range r.Header {\n        if len(v) == 0 {\n            a = append(a, k)\n        } else if len(v) == 1 {\n            s = fmt.Sprintf(\"  %s: %v\", k, v[0])\n            a = append(a, s)\n        } else {\n            a = append(a, \"  \"+k+\":\")\n            for _, v2 := range v {\n                a = append(a, \"    \"+v2)\n            }\n        }\n    }\n\n    a = append(a, \"\")\n    a = append(a, fmt.Sprintf(\"ver: https://github.com/kjk/go-cookbook/commit/%s\", sha1ver))\n    a = append(a, fmt.Sprintf(\"built on: %s\", buildTime))\n\n    s = strings.Join(a, \"\\n\")\n    servePlainText(w, s)\n}\n\nfunc makeHTTPServer() *http.Server {\n    mux := \u0026http.ServeMux{}\n\n    mux.HandleFunc(\"/app/debug\", handleDebug)\n\n    return \u0026http.Server{\n        ReadTimeout:  5 * time.Second,\n        WriteTimeout: 5 * time.Second,\n        IdleTimeout:  120 * time.Second,\n        Handler:      mux,\n    }\n}\n\nfunc startHTTPServer() {\n    httpAddr := \"127.0.0.1:4040\"\n    httpSrv := makeHTTPServer()\n    httpSrv.Addr = httpAddr\n    fmt.Printf(\"Visit http://%s/app/debug\\n\", httpAddr)\n    err := httpSrv.ListenAndServe()\n    if err != nil {\n        log.Fatalf(\"httpSrv.ListendAndServe() failed with %s\\n\", err)\n    }\n}"
            ]
          ]
        },
        "type": "code",
        "version": 3,
        "code": "func servePlainText(w http.ResponseWriter, s string) {\n    w.Header().Set(\"Content-Type\", \"text/plain\")\n    w.Header().Set(\"Content-Length\", strconv.Itoa(len(s)))\n    w.WriteHeader(http.StatusOK)\n    w.Write([]byte(s))\n}\n\n// /app/debug\nfunc handleDebug(w http.ResponseWriter, r *http.Request) {\n    s := fmt.Sprintf(\"url: %s %s\", r.Method, r.RequestURI)\n    a := []string{s}\n\n    a = append(a, \"Headers:\")\n    for k, v := range r.Header {\n        if len(v) == 0 {\n            a = append(a, k)\n        } else if len(v) == 1 {\n            s = fmt.Sprintf(\"  %s: %v\", k, v[0])\n            a = append(a, s)\n        } else {\n            a = append(a, \"  \"+k+\":\")\n            for _, v2 := range v {\n                a = append(a, \"    \"+v2)\n            }\n        }\n    }\n\n    a = append(a, \"\")\n    a = append(a, fmt.Sprintf(\"ver: https://github.com/kjk/go-cookbook/commit/%s\", sha1ver))\n    a = append(a, fmt.Sprintf(\"built on: %s\", buildTime))\n\n    s = strings.Join(a, \"\\n\")\n    servePlainText(w, s)\n}\n\nfunc makeHTTPServer() *http.Server {\n    mux := \u0026http.ServeMux{}\n\n    mux.HandleFunc(\"/app/debug\", handleDebug)\n\n    return \u0026http.Server{\n        ReadTimeout:  5 * time.Second,\n        WriteTimeout: 5 * time.Second,\n        IdleTimeout:  120 * time.Second,\n        Handler:      mux,\n    }\n}\n\nfunc startHTTPServer() {\n    httpAddr := \"127.0.0.1:4040\"\n    httpSrv := makeHTTPServer()\n    httpSrv.Addr = httpAddr\n    fmt.Printf(\"Visit http://%s/app/debug\\n\", httpAddr)\n    err := httpSrv.ListenAndServe()\n    if err != nil {\n        log.Fatalf(\"httpSrv.ListendAndServe() failed with %s\\n\", err)\n    }\n}",
        "code_language": "Go"
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786896,
        "id": "f2624055-e427-48c5-b8e6-b18dfdd88b2e",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531888786896,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "In addition to printing version of the code I also show HTTP headers. During debugging, the more information, the better."
            ]
          ]
        },
        "type": "text",
        "version": 1,
        "inline_content": [
          {
            "Text": "In addition to printing version of the code I also show HTTP headers. During debugging, the more information, the better."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1531888786896,
        "id": "112805bf-cf9c-4c00-ab26-a21bca7c00e5",
        "ignore_block_count": true,
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1531889687184,
        "parent_id": "39d17339-1739-4a9d-bf99-ffafa20c2a96",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Code for this chapter: "
            ],
            [
              "https://github.com/kjk/go-cookbook/tree/master/embed-build-number",
              [
                [
                  "a",
                  "https://github.com/kjk/go-cookbook/tree/master/embed-build-number"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 7,
        "inline_content": [
          {
            "Text": "Code for this chapter: "
          },
          {
            "Text": "https://github.com/kjk/go-cookbook/tree/master/embed-build-number",
            "Link": "https://github.com/kjk/go-cookbook/tree/master/embed-build-number"
          }
        ]
      }
    ],
    "title": "Embedding build number in Go executable",
    "format_page": {
      "page_cover": "https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f4649414-a80a-475f-92bf-dfda91b0689a/header-10.jpg",
      "page_cover_position": 0.5,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true,
      "page_cover_url": "https://www.notion.so/image/https:%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Ff4649414-a80a-475f-92bf-dfda91b0689a%2Fheader-10.jpg"
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 10
    }
  ],
  "Tables": null
}