{
  "ID": "d141f09a-fbd3-423d-8aab-3085fba6b124",
  "Root": {
    "alive": true,
    "content": [
      "759a0fa3-6e2a-4880-94b9-fb324606dd64",
      "64d2cb56-a6e7-4535-a82f-96f6adb7815e",
      "af128bc6-9044-4655-82ab-7f1be7d026a2",
      "07133d10-5c59-411c-8d08-0a491bf929c7",
      "a64b365d-969b-47ac-b283-db89b4f39156",
      "af62bbb3-f452-4ad2-9853-b2668c4c3d42",
      "a16d7702-16cb-44ac-a2a7-baecd14b729d",
      "8e77840e-3567-431b-81e3-6ca35f0a64d0",
      "8fcc437b-91fb-429a-9b77-39a0b9263a99",
      "0df88034-d5c3-4d2c-815d-9e1d9d0c5a98",
      "4d6be2ab-da90-4e2f-94d8-a425eb1bc57c",
      "a40ea79b-d4bc-43b8-ad3b-1a93f40583ae",
      "2239c79f-a2d6-4e56-bce8-a313c3f3b389",
      "dabb6d96-67f7-4901-b0dc-9493eb70c483",
      "1f3b190b-fdc1-4442-a4b2-21c45b37e746",
      "c3759272-d4a1-44fe-9e30-9dc951685e35",
      "fcb8f078-172d-42d6-a004-264254e8f566",
      "03714e32-2221-4551-aa3d-bd518ab1bcf2"
    ],
    "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "created_time": 1545685636669,
    "format": {
      "page_full_width": true,
      "page_small_text": true
    },
    "id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
    "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
    "last_edited_time": 1545688194557,
    "parent_id": "21236666-884a-4407-bb7d-f39f819f0135",
    "parent_table": "block",
    "properties": {
      "title": [
        [
          "Research on embedding dll"
        ]
      ]
    },
    "type": "page",
    "version": 206,
    "content_resolved": [
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545685665918,
        "id": "759a0fa3-6e2a-4880-94b9-fb324606dd64",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545685737422,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "The idea is to create a single "
            ],
            [
              ".exe",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " executable even if it uses dlls by embedding dlls as resources and somehow tricking Windows so that "
            ],
            [
              "LoadLibrary",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " loads them from there."
            ]
          ]
        },
        "type": "text",
        "version": 561,
        "inline_content": [
          {
            "Text": "The idea is to create a single "
          },
          {
            "Text": ".exe",
            "AttrFlags": 2
          },
          {
            "Text": " executable even if it uses dlls by embedding dlls as resources and somehow tricking Windows so that "
          },
          {
            "Text": "LoadLibrary",
            "AttrFlags": 2
          },
          {
            "Text": " loads them from there."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545685737741,
        "id": "64d2cb56-a6e7-4535-a82f-96f6adb7815e",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545685744229,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Simple solution"
            ]
          ]
        },
        "type": "sub_header",
        "version": 44,
        "inline_content": [
          {
            "Text": "Simple solution"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545685744460,
        "id": "af128bc6-9044-4655-82ab-7f1be7d026a2",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686387057,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Mark libraries as delay loaded and on startup extract them to a unique directory and add that directory to load library path (so that "
            ],
            [
              "LoadLibrary",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " picks it up) or pre-load with "
            ],
            [
              "LoadLibrary",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and absolute path, which should work for delay loaded libs."
            ]
          ]
        },
        "type": "text",
        "version": 721,
        "inline_content": [
          {
            "Text": "Mark libraries as delay loaded and on startup extract them to a unique directory and add that directory to load library path (so that "
          },
          {
            "Text": "LoadLibrary",
            "AttrFlags": 2
          },
          {
            "Text": " picks it up) or pre-load with "
          },
          {
            "Text": "LoadLibrary",
            "AttrFlags": 2
          },
          {
            "Text": " and absolute path, which should work for delay loaded libs."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686388839,
        "id": "07133d10-5c59-411c-8d08-0a491bf929c7",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686394611,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Hook LoadLibrary"
            ]
          ]
        },
        "type": "sub_header",
        "version": 46,
        "inline_content": [
          {
            "Text": "Hook LoadLibrary"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686394886,
        "id": "a64b365d-969b-47ac-b283-db89b4f39156",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686607429,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Another option is to use e.g. "
            ],
            [
              "detours ",
              [
                [
                  "a",
                  "https://github.com/Microsoft/Detours"
                ]
              ]
            ],
            [
              "library to hook "
            ],
            [
              "LoadLibrary",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " call. If the file name matches our library, use custom implementation of LoadLibrary. Or call original LoadLibrary first and only if it fails and name matches, load custom (that way it'll pick up library if it's on disk."
            ]
          ]
        },
        "type": "text",
        "version": 786,
        "inline_content": [
          {
            "Text": "Another option is to use e.g. "
          },
          {
            "Text": "detours ",
            "Link": "https://github.com/Microsoft/Detours"
          },
          {
            "Text": "library to hook "
          },
          {
            "Text": "LoadLibrary",
            "AttrFlags": 2
          },
          {
            "Text": " call. If the file name matches our library, use custom implementation of LoadLibrary. Or call original LoadLibrary first and only if it fails and name matches, load custom (that way it'll pick up library if it's on disk."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686524867,
        "id": "af62bbb3-f452-4ad2-9853-b2668c4c3d42",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686624541,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Writing custom LoadLibrary might be hard. Some links:"
            ]
          ]
        },
        "type": "text",
        "version": 157,
        "inline_content": [
          {
            "Text": "Writing custom LoadLibrary might be hard. Some links:"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686625191,
        "id": "a16d7702-16cb-44ac-a2a7-baecd14b729d",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686629468,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "https://www.joachim-bauch.de/tutorials/loading-a-dll-from-memory/",
              [
                [
                  "a",
                  "https://www.joachim-bauch.de/tutorials/loading-a-dll-from-memory/"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 14,
        "inline_content": [
          {
            "Text": "https://www.joachim-bauch.de/tutorials/loading-a-dll-from-memory/",
            "Link": "https://www.joachim-bauch.de/tutorials/loading-a-dll-from-memory/"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686630289,
        "id": "8e77840e-3567-431b-81e3-6ca35f0a64d0",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686640185,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "https://github.com/fancycode/MemoryModule",
              [
                [
                  "a",
                  "https://github.com/fancycode/MemoryModule"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 7,
        "inline_content": [
          {
            "Text": "https://github.com/fancycode/MemoryModule",
            "Link": "https://github.com/fancycode/MemoryModule"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686641695,
        "id": "8fcc437b-91fb-429a-9b77-39a0b9263a99",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686653071,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "https://github.com/taviso/loadlibrary",
              [
                [
                  "a",
                  "https://github.com/taviso/loadlibrary"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 7,
        "inline_content": [
          {
            "Text": "https://github.com/taviso/loadlibrary",
            "Link": "https://github.com/taviso/loadlibrary"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686653990,
        "id": "0df88034-d5c3-4d2c-815d-9e1d9d0c5a98",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686878168,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "http://www.rohitab.com/discuss/topic/39179-loadlibrary-replacement/",
              [
                [
                  "a",
                  "http://www.rohitab.com/discuss/topic/39179-loadlibrary-replacement/"
                ]
              ]
            ],
            [
              " : simple implementation of LoadLibrary"
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 93,
        "inline_content": [
          {
            "Text": "http://www.rohitab.com/discuss/topic/39179-loadlibrary-replacement/",
            "Link": "http://www.rohitab.com/discuss/topic/39179-loadlibrary-replacement/"
          },
          {
            "Text": " : simple implementation of LoadLibrary"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686895634,
        "id": "4d6be2ab-da90-4e2f-94d8-a425eb1bc57c",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545686895951,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "http://blog.aaronballman.com/2011/08/what-happens-when-you-load-a-library/",
              [
                [
                  "a",
                  "http://blog.aaronballman.com/2011/08/what-happens-when-you-load-a-library/"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 7,
        "inline_content": [
          {
            "Text": "http://blog.aaronballman.com/2011/08/what-happens-when-you-load-a-library/",
            "Link": "http://blog.aaronballman.com/2011/08/what-happens-when-you-load-a-library/"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545686897001,
        "id": "a40ea79b-d4bc-43b8-ad3b-1a93f40583ae",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545687439309,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "http://hatriot.github.io/blog/2017/09/19/abusing-delay-load-dll/",
              [
                [
                  "a",
                  "http://hatriot.github.io/blog/2017/09/19/abusing-delay-load-dll/"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 7,
        "inline_content": [
          {
            "Text": "http://hatriot.github.io/blog/2017/09/19/abusing-delay-load-dll/",
            "Link": "http://hatriot.github.io/blog/2017/09/19/abusing-delay-load-dll/"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545687507953,
        "id": "2239c79f-a2d6-4e56-bce8-a313c3f3b389",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545687603826,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "https://web.archive.org/web/20140416033522/http://blogs.msdn.com/b/mgrier/archive/2005/06/18/430402.aspx",
              [
                [
                  "a",
                  "https://web.archive.org/web/20140416033522/http://blogs.msdn.com/b/mgrier/archive/2005/06/18/430402.aspx"
                ]
              ]
            ],
            [
              " : how nt loader works"
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 57,
        "inline_content": [
          {
            "Text": "https://web.archive.org/web/20140416033522/http://blogs.msdn.com/b/mgrier/archive/2005/06/18/430402.aspx",
            "Link": "https://web.archive.org/web/20140416033522/http://blogs.msdn.com/b/mgrier/archive/2005/06/18/430402.aspx"
          },
          {
            "Text": " : how nt loader works"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545688020956,
        "id": "dabb6d96-67f7-4901-b0dc-9493eb70c483",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545688021257,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "https://www.malwaretech.com/2013/09/fighting-hooks-with-hooks-sandbox-escape.html",
              [
                [
                  "a",
                  "https://www.malwaretech.com/2013/09/fighting-hooks-with-hooks-sandbox-escape.html"
                ]
              ]
            ]
          ]
        },
        "type": "bulleted_list",
        "version": 7,
        "inline_content": [
          {
            "Text": "https://www.malwaretech.com/2013/09/fighting-hooks-with-hooks-sandbox-escape.html",
            "Link": "https://www.malwaretech.com/2013/09/fighting-hooks-with-hooks-sandbox-escape.html"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545687604311,
        "id": "1f3b190b-fdc1-4442-a4b2-21c45b37e746",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545688247109,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "LoadLibrary ",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "is implemented with "
            ],
            [
              "LdrLoadDll",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 107,
        "inline_content": [
          {
            "Text": "LoadLibrary ",
            "AttrFlags": 2
          },
          {
            "Text": "is implemented with "
          },
          {
            "Text": "LdrLoadDll",
            "AttrFlags": 2
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545687552361,
        "id": "c3759272-d4a1-44fe-9e30-9dc951685e35",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545688238671,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Hook lower-level library used by LoadLibrary"
            ]
          ]
        },
        "type": "sub_header",
        "version": 108,
        "inline_content": [
          {
            "Text": "Hook lower-level library used by LoadLibrary"
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545687560863,
        "id": "fcb8f078-172d-42d6-a004-264254e8f566",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545688241391,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Writing "
            ],
            [
              "LoadLibrary ",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              "might be hard so what if we hooked just lower-level file access. Those seem to be "
            ],
            [
              "NtOpenFile",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              " and the ones for mapping file into memory like "
            ],
            [
              "NtMapViewOfSection",
              [
                [
                  "c"
                ]
              ]
            ],
            [
              ". This is also difficult and would have to use undocumented structures."
            ]
          ]
        },
        "type": "text",
        "version": 635,
        "inline_content": [
          {
            "Text": "Writing "
          },
          {
            "Text": "LoadLibrary ",
            "AttrFlags": 2
          },
          {
            "Text": "might be hard so what if we hooked just lower-level file access. Those seem to be "
          },
          {
            "Text": "NtOpenFile",
            "AttrFlags": 2
          },
          {
            "Text": " and the ones for mapping file into memory like "
          },
          {
            "Text": "NtMapViewOfSection",
            "AttrFlags": 2
          },
          {
            "Text": ". This is also difficult and would have to use undocumented structures."
          }
        ]
      },
      {
        "alive": true,
        "created_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "created_time": 1545688194557,
        "id": "03714e32-2221-4551-aa3d-bd518ab1bcf2",
        "last_edited_by": "bb760e2d-d679-4b64-b2a9-03005b21870a",
        "last_edited_time": 1545688230701,
        "parent_id": "d141f09a-fbd3-423d-8aab-3085fba6b124",
        "parent_table": "block",
        "properties": {
          "title": [
            [
              "Chrome has code for intercepting them: "
            ],
            [
              "https://cs.chromium.org/chromium/src/sandbox/win/src/target_interceptions.cc?q=TargetNtMa\u0026sq=package:chromium\u0026g=0\u0026l=27",
              [
                [
                  "a",
                  "https://cs.chromium.org/chromium/src/sandbox/win/src/target_interceptions.cc?q=TargetNtMa\u0026sq=package:chromium\u0026g=0\u0026l=27"
                ]
              ]
            ],
            [
              " (or search for "
            ],
            [
              "TargetNtMapViewOfSection",
              [
                [
                  "c"
                ]
              ]
            ]
          ]
        },
        "type": "text",
        "version": 181,
        "inline_content": [
          {
            "Text": "Chrome has code for intercepting them: "
          },
          {
            "Text": "https://cs.chromium.org/chromium/src/sandbox/win/src/target_interceptions.cc?q=TargetNtMa\u0026sq=package:chromium\u0026g=0\u0026l=27",
            "Link": "https://cs.chromium.org/chromium/src/sandbox/win/src/target_interceptions.cc?q=TargetNtMa\u0026sq=package:chromium\u0026g=0\u0026l=27"
          },
          {
            "Text": " (or search for "
          },
          {
            "Text": "TargetNtMapViewOfSection",
            "AttrFlags": 2
          }
        ]
      }
    ],
    "title": "Research on embedding dll",
    "format_page": {
      "page_cover": "",
      "page_cover_position": 0,
      "page_font": "",
      "page_full_width": true,
      "page_icon": "",
      "page_small_text": true
    }
  },
  "Users": [
    {
      "email": "kkowalczyk@gmail.com",
      "family_name": "Kowalczyk",
      "given_name": "Krzysztof",
      "id": "bb760e2d-d679-4b64-b2a9-03005b21870a",
      "locale": "en",
      "mobile_onboarding_completed": true,
      "onboarding_completed": true,
      "profile_photo": "https://s3-us-west-2.amazonaws.com/public.notion-static.com/2dcaa66c-7674-4ff6-9924-601785b63561/head-bw-640x960.png",
      "time_zone": "America/Los_Angeles",
      "version": 10
    }
  ],
  "Tables": null
}